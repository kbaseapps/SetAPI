[![Build Status](https://travis-ci.org/msneddon/SetAPI.svg?branch=master)](https://travis-ci.org/msneddon/SetAPI)

# SetAPI
---

This is the basic readme for this module. Include any usage or deployment instructions and links to other documentation here.


## Contributing
---
This is a [KBase](https://kbase.us) module generated by the [KBase Software Development Kit (SDK)](https://github.com/kbase/kb_sdk).

You will need to have the SDK installed to use this module if you want to make any changes to the spec or the API. However, other development work does not require the SDK and can be done locally.

[Learn more about the SDK and how to use it](https://kbase.github.io/kb_sdk_docs/).

## Set up

The SetAPI repo has been developed and tested using Python 3.10. There are three sets of dependencies for the repo:

* `requirements.txt` - packages required for runtime
* `requirements-test.txt` - packages used in testing and generating coverage
* `requirements-dev.txt` - includes a range of extra tools for formatting and linting code.

The contents of the three files are mutually exclusive, so all three should be installed for the full development environment.

Pip is not always completely reliable at pulling in package dependencies, so it is recommended that you install packages one at a time as follows:

```bash
$ cat requirements.txt | sed -e '/^\s*#.*$/d' -e '/^\s*$/d' | xargs -n 1 pip install
```

...substituting in the appropriate requirements file name.

## Tests

Tests do not require the use of the SDK or a test token. They can be run using the shell script `test/run_tests.sh`, or directly from the command line:

```bash
$ export PYTHONPATH=$PYTHONPATH:$(pwd)/lib
$ pytest test
```

## API changes

If you make changes to the spec (and thus the API) of the SetAPI app, you will need to recompile the app to generate updated versions of `SetAPIImpl.py`, `SetAPIServer.py`, and the compilation report, `compile_report.json`. These updated files must be committed to the GitHub repo.

Note that there is a bug in some versions of the SDK that assumes the wrong location for the `baseclient.py` and `authclient.py` files. To fix it, after compilation, edit the `SetAPIServer.py` file to amend the following lines:

find (around line 19):
```py
from biokbase import log
from SetAPI.authclient import KBaseAuth as _KBaseAuth
```

replace with:
```py
from biokbase import log
from installed_clients.authclient import KBaseAuth as _KBaseAuth
```
